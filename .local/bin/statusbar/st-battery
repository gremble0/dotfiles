#!/bin/sh

[ $(ls /sys/class/power_supply/ -l | grep "BAT*" | wc -l) = 0 ] && exit 0

# TODO: find a better way to find battery name (maybe just export as environment variable in zprofile?)
BAT=$(ls -l /sys/class/power_supply | grep "BAT*" | cut -d " " -f 11)
status=$(cat /sys/class/power_supply/$BAT/status)
capacity=$(cat /sys/class/power_supply/$BAT/capacity)

if [ "$status" = "Not charging" ]; then
    echo -e "\x03󰂅  \x01$capacity%" && exit 0
elif [ "$status" = "Charging" ]; then
    [ $capacity -gt 80 ] && echo -e "\x03󰂋  \x01$capacity%" && exit 0
    [ $capacity -gt 60 ] && echo -e "\x03󰢞  \x01$capacity%" && exit 0
    [ $capacity -gt 40 ] && echo -e "\x03󰢝  \x01$capacity%" && exit 0
    [ $capacity -gt 20 ] && echo -e "\x03󰂇  \x01$capacity%" && exit 0
    echo -e "󰢜 $capacity%"
else
    [ $capacity -gt 80 ] && echo -e "\x03󰂂 \x01$capacity%" && exit 0
    [ $capacity -gt 60 ] && echo -e "\x03󰂀 \x01$capacity%" && exit 0
    [ $capacity -gt 40 ] && echo -e "\x03󰁾 \x01$capacity%" && exit 0
    [ $capacity -gt 20 ] && echo -e "\x03󰁼 \x01$capacity%" && exit 0
    echo -e "󰁺 $capacity%"
fi
